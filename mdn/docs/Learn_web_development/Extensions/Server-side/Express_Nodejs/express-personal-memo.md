# 1. Nginx / Express基本的な違い

| 項目       | Nginx                               | Express (Node.js)                          |
|------------|------------------------------------|-------------------------------------------|
| 種類       | Webサーバー / リバースプロキシ      | Webアプリケーションフレームワーク        |
| 言語       | C                                  | JavaScript (Node.js上で動作)              |
| 主な用途   | 静的コンテンツ配信、リバースプロキシ、ロードバランサー | 動的WebアプリやAPIの作成、サーバーサイドロジック |
| 動作方式   | イベント駆動型（非同期、マルチプロセス） | シングルスレッドイベントループ（非同期I/O） |
| 性能       | 高速で低メモリ、同時接続数が多くても強い | アプリ処理に依存するので、大量同時接続はNginxに比べると弱い |
| 例         | 静的サイトを高速配信、APIサーバー前段でリクエストを振り分ける | REST APIやWebアプリのルーティング・処理を作る |

### Nginx と Express の処理方式の違い

##### 1. Nginx: イベント駆動型（非同期、マルチプロセス）

- **イベント駆動型**  
  - リクエストが来ると「イベント」として処理を登録  
  - 処理中でも他のリクエストを同じプロセスで同時に処理可能

- **非同期**  
  - データベースやファイル読み書きなどの時間がかかる処理も待たずに次のリクエストを処理

- **マルチプロセス**  
  - CPUコアごとに複数のプロセスを立てることで、並列処理能力が高い

💡 ポイント:  
- 大量同時接続でも高速・低メモリ  
- 静的ファイル配信やリバースプロキシに最適


##### 2. Express (Node.js): シングルスレッドイベントループ（非同期I/O）

- **シングルスレッド**  
  - 基本的に1つのスレッドでリクエストを処理

- **イベントループ**  
  - 待ち時間のある処理（DBアクセスやファイル読み込み）は非同期に登録して、先に次のリクエストを処理

- **非同期I/O**  
  - 時間のかかる処理を待たずにCPUを有効活用

💡 ポイント:  
- 中小規模アプリなら十分高速  
- 大規模アクセスでは Nginx と組み合わせると安定

---

## 3. 違いのイメージ

Nginx: Node.js/Express:
+---------+ +---------+
|リクエスト| ---> [処理] |リクエスト| ---> [処理]
|リクエスト| ---> [処理] |リクエスト| --\
|リクエスト| ---> [処理] |リクエスト| --> 非同期I/Oに回す
+---------+ +---------+
（マルチプロセスで並列） （1スレッドで順次、I/Oは非同期）

markdown
コードをコピーする

💡まとめ:  
- **Nginx** → 高速・大量同時接続向き（静的ファイル・プロキシ向き）  
- **Express** → 動的処理向き（APIやWebアプリ）

# 2. 役割のイメージ

## Nginx
- 入口（ゲート）としてリクエストを受ける
- 「静的ファイルは自分で返す」「動的リクエストはバックエンドに渡す」
- ロードバランスやキャッシュも担当

## Express
- Webアプリの本体
- 受け取ったリクエストに対して処理を実行
- データベースアクセス、APIレスポンス生成、ユーザー認証などを担当

# 3. 構成
### Express構成
```
[ブラウザ] --> [Nginx] --> [Express (Node.js)]
|--> 静的ファイルを返す
|--> APIリクエストをExpressに転送
```


### Rails構成
```
[ブラウザ] --> [Nginx] --> [Rails (Puma/Unicorn)]
|--> 静的ファイルを返す
|--> 動的リクエストをRailsに転送
```
