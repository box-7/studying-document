# ドキュメントオブジェクトモデル (DOM) の使い方

[ドキュメントオブジェクトモデルの使い方](https://developer.mozilla.org/ja/docs/Web/API/Document_Object_Model/Using_the_Document_Object_Model)


DOM は HTML や XML 文書のツリー構造を操作するための API で、ウェブ上のスクリプティングの基盤になる。

## DOM ツリーとは

- DOM ツリーは文書の内容を表すノードのツリー構造
- 各 HTML または XML 文書は固有の DOM ツリーを持つ

### 例

```html
<!-- html -->

<html lang="en">
  <head>
    <title>My Document</title>
  </head>
  <body>
    <h1>Header</h1>
    <p>Paragraph</p>
  </body>
</html>
```


### DOM ツリー例

- Document
  - HTML
    - HEAD
      - TITLE
        - "My document"
    - BODY
      - H1
        - "Header"
      - P
        - "Paragraph"



# 文書 API（DOM API）の基本

文書 API を使うと、HTML や XML の DOM ツリーを自由に読み書き・変更できる。  
JavaScript からはグローバルオブジェクト `document` を通して操作でき、`document` は `Document` インターフェイスを実装している。


## DOM の読み取りと変更の例

### HTML

```html
<!-- html -->
<html lang="ja">
  <head>
    <title>文書</title>
  </head>
  <body>
    <input type="button" value="この文書を変更" />
    <h2>見出し</h2>
    <p>段落</p>
  </body>
</html>
```

```js
// js
document.querySelector("input").addEventListener("click", () => {
  // ヘッダーの取得
  //  .item(0) でそのコレクションの 最初の要素（インデックス 0） を取り出す
  const header = document.getElementsByTagName("h2").item(0);
  //  firstChild は その要素の最初の子ノード を指すプロパティ
 // テキストを変更
  header.firstChild.data = "動的文書";

  // 最初の段落の取得と変更
  const para = document.getElementsByTagName("p").item(0);
  para.firstChild.data = "これが最初の段落です。";

  // 2 番目の段落を作成
  const newText = document.createTextNode("これが 2 番目の段落です。");
  const newElement = document.createElement("p");
  newElement.appendChild(newText);

  // 文書の最後に追加
  // parentNode は そのノードの親ノードを指すプロパティ
  para.parentNode.appendChild(newElement);
});
```

### ツリーの作成
```js
// 要素（タグ） → Element ノードとして作成
const root = document.createElement("html");
root.lang = "ja";

const head = document.createElement("head");
const title = document.createElement("title");

// テキスト（文字列） → Text ノードとして作成
title.appendChild(document.createTextNode("My Document"));
head.appendChild(title);

const body = document.createElement("body");
const header = document.createElement("h1");
header.appendChild(document.createTextNode("Header"));
const paragraph = document.createElement("p");
paragraph.appendChild(document.createTextNode("Paragraph"));
body.appendChild(header);
body.appendChild(paragraph);

root.appendChild(head);
root.appendChild(body);
```

